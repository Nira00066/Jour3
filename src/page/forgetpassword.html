<!DOCTYPE html>
<html lang="fr">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Mot de passe oubli√© - MyJob MyDream</title>
    <link rel="stylesheet" href="./../css/form.css" />
    <link rel="stylesheet" href="./../css/home.css" />
    <link rel="stylesheet" href="./../css/modal.css" />
  </head>
  <body>
    <header>
      <div class="title"><h1>MyJob MyDream</h1></div>

      <!-- Menu hamburger -->
      <div class="menu-toggle" id="menu-toggle">‚ò∞</div>

      <nav id="nav">
        <ul>
          <li><a href="index.html">Accueil</a></li>
          <li><a href="form.html">Postuler</a></li>
          <li><a href="connexion.html">Connexion</a></li>
        </ul>
      </nav>

      <a href="index.html" class="btn-connexion">Accueil</a>
    </header>

    <main>
      <h2>Mot de passe oubli√©</h2>
      <form
        class="formulaire"
        id="resetForm"
        action="/forgotPassword"
        method="post"
      >
        <label for="email">Entrez votre adresse Email :</label>
        <input type="email" id="email" name="email" required />

        <button type="submit">Envoyer le lien</button>

        <!-- Retour √† la connexion -->
        <p class="redirect">
          <a href="connexion.html">Retour √† la connexion</a>
        </p>
      </form>
    </main>

    <footer>
      <ul>
        <li>Connexion</li>
        <li>Inscription</li>
        <li>Postulations</li>
      </ul>
      <h4>&copy; 2025 - Tous droits r√©serv√©s</h4>
    </footer>

    <!-- ‚úÖ MODAL -->
    <div class="modal" id="resetModal">
      <div class="modal-content">
        <h3>üìß Email envoy√© !</h3>
        <p>Un lien de r√©initialisation a √©t√© envoy√© √† votre adresse email.</p>
        <button id="closeResetModal">OK</button>
      </div>
    </div>

    <script>
      // Menu hamburger
      const menuToggle = document.getElementById("menu-toggle");
      const nav = document.getElementById("nav");
      menuToggle.addEventListener("click", () => {
        nav.classList.toggle("active");
        menuToggle.classList.toggle("open");
      });

      // Modal mot de passe oubli√©
      const resetForm = document.getElementById("resetForm");
      const resetModal = document.getElementById("resetModal");
      const closeResetModal = document.getElementById("closeResetModal");

      resetForm.addEventListener("submit", async (e) => {
        e.preventDefault();
        const email = document.getElementById("email").value;

        try {
          const response = await fetch("http://localhost:3000/forgotPassword", {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({ email }),
          });

          if (response.ok) {
            // Modal succ√®s
            resetModal.style.display = "flex";
          } else {
            // Modal erreur
            alert("Erreur lors de l'envoi du mail");
          }
        } catch (err) {
          alert("Erreur serveur, veuillez r√©essayer");
        }
      });

      // Fermer la modal quand on clique sur le bouton OK
      closeResetModal.addEventListener("click", () => {
        resetModal.style.display = "none";
      });
    </script>
  </body>
</html>
